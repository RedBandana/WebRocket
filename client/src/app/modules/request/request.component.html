<div class="requestContainer">
    
    <select class="language-switcher" [(ngModel)]="selectedLanguage" (change)="changeLanguage($event)">
        <option value="en">EN</option>
        <option value="fr">FR</option>
    </select>

    <div class="requestAgent">
        <div class="requestAgentProfile">
            <img [src]="user?.profilepictureurl">
        </div>
        
        <h2 *ngIf="user; else rocket">{{ user.firstName }} {{ user.lastName }}</h2>
        <ng-template #rocket>
            <h2 class="requestAgentName">
                Laurent Belanger
            </h2>
        </ng-template>
        
        <h2 class="requestAgentDescription">
            We lead, inspire and help others go into business for themselves.
        </h2>
    </div>

    <div class="requestTitle">
        <h1>Join Rocket Team</h1>
    </div>


    <form class="requestForm" [formGroup]="requestForm">
        <div class="requestField" [ngClass]="{'error': requestForm.get('firstName')?.touched && requestForm.get('firstName')?.invalid}">
            <label for="firstName">First name</label>
            <input type="text" id="firstName" formControlName="firstName" required />
        </div>
        <div class="requestField" [ngClass]="{'error': requestForm.get('lastName')?.touched && requestForm.get('lastName')?.invalid}">
            <label for="lastName">Last name</label>
            <input type="text" id="lastName" formControlName="lastName" required />
        </div>
        <div class="requestField" [ngClass]="{'error': requestForm.get('email')?.touched && requestForm.get('email')?.invalid}">
            <label for="email">Email</label>
            <input type="email" id="email" formControlName="email" required />
        </div>
        <div class="requestField" [ngClass]="{'error': requestForm.get('phone')?.touched && requestForm.get('phone')?.invalid}">
            <label for="phone">Phone</label>
            <input type="tel" pattern="^\(?\d{3}\)?[\s.-]?\d{3}[\s.-]?\d{4}$" id="phone" formControlName="phone" required />
        </div>
        <div class="requestField" [ngClass]="{'error': requestForm.get('introducedBy')?.touched && requestForm.get('introducedBy')?.invalid}">
            <label for="introducedBy">Introduced by</label>
            <input type="text" id="introducedBy" formControlName="introducedBy" />
        </div>
        <div class="requestField" [ngClass]="{'error': requestForm.get('mainInterest')?.touched && requestForm.get('mainInterest')?.invalid}">
            <label for="mainInterest">Main interest</label>
            <select id="mainInterest" formControlName="mainInterest" required>
                <option value="" disabled selected>Select an option</option>
                <option value="find opportunity" selected>Find a business opportunity</option>
                <option value="improve situation">Improve my financial situation</option>
            </select>
        </div>

        <button class="requestSubmit" type="button" (click)="join()"
            [disabled]="requestLoading || userLoading">{{ 'joinFormSubmit' | translate }}</button>

        <div class="loadingIndicator" [ngClass]="{'hide': !requestLoading && !userLoading}">
            <div class="loadingBar"></div>
        </div>

        <!-- Display success or error message -->
        <div class="requestNotif requestNotifError" *ngIf="requestError || userError || errorMessage">
            <div class="requestNotifIcon">
                <i class="fa-regular fa-circle-xmark"></i>
            </div>
            <div class="requestNotifText">
                {{ errorMessage }}
                {{ requestError }}
                {{ userError }}
            </div>
        </div>
        <div class="requestNotif requestNotifSuccess" *ngIf="request && !errorMessage">
            <div class="requestNotifIcon">
                <i class="fa-regular fa-circle-check"></i>
            </div>
            <div class="requestNotifText">
                An agent will contact you in the next 24&nbsp;h.
            </div>
        </div>

        <div class="requestFooter">
            <a href="/terms-of-use" target="_blank">Terms of use </a> | <a href="/privacy-policy"
                target="_blank">Privacy policy</a>
        </div>
    </form>
</div>